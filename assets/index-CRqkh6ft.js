var q=Object.defineProperty;var Z=(h,e,t)=>e in h?q(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var o=(h,e,t)=>Z(h,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();class l{static appendElement(e,t,i,n,r){const a=document.createElement(t);if(e.appendChild(a),i){typeof i=="string"&&(i=[i]);for(const p of i)a.classList.add(p)}n&&(a.textContent=n);for(const p in r)a.setAttribute(p,String(r[p]));return a}}const c=document.getElementById("root");class Y{static show(e){const t=l.appendElement(c,"div",null,null,{id:"game-over-overlay"}),i=l.appendElement(t,"div",null,null,{id:"game-over-container"});l.appendElement(i,"div",null,null,{id:"game-over-title"}).textContent="GAME OVER",l.appendElement(i,"div",null,null,{id:"game-over-score"}).textContent=`Score: ${e}`;const n=l.appendElement(i,"button",null,null,{id:"restart-button"});n.textContent="RESTART",n.addEventListener("click",()=>{window.location.reload()}),window.addEventListener("keydown",r=>{r.key==="Enter"&&window.location.reload()})}}class s{static positionToNumber(e){return Number(e.split("p")[0])}static rng(e,t){return Math.random()*(t-e)+e}static gameOver(e=0){Y.show(e)}static convertTime(e,t=100){return Math.round(e/t)}static isTimeTo(e,t,i=0,n=100){return this.convertTime(e,n)%t===0&&this.convertTime(e,n)!==i}}class w{static createDeathStarHtml(){const e=l.appendElement(c,"img","deathStar",null,{src:"./images/deathstar.png",id:"deathstar"});return e.style.height="200px",e.style.position="fixed",e.style.left=window.innerWidth+400+"px",e}static createXWingHtml(){const e=l.appendElement(c,"img","xWing",null,{src:"./images/XWingright.png",id:"xwing"});return e.style.position="relative",e.style.top=window.innerHeight/2+"px",e.style.height="75px",e}static createTieFighter(e){const t=l.appendElement(c,"img","tie",null,{src:"./images/TIEfighter.png",id:"tie"});return t.style.position="absolute",t.style.top=e+"px",t.style.left=window.innerWidth+100+"px",t}static createShuttle(e){const t=l.appendElement(c,"img","shuttle",null,{src:"./images/shuttle.png"});let i=t.style;return i.height="80px",i.position="fixed",i.top=e+"px",i.left=window.innerWidth+"px",t}static createStarDestroyer(e){const t=l.appendElement(c,"img","starDestroyer",null,{src:"./images/starDestroyer.png"});let i=t.style;return e&&(i.top=e+"px"),i.height="100px",i.position="fixed",i.left=window.innerWidth+400+"px",t}static createSithFighter(e){const t=l.appendElement(c,"img","teleporter",null,{src:"./images/teleporter.png"});let i=t.style;return i.zIndex="2",e&&(i.top=e+"px"),i.height="30px",i.position="fixed",i.left=window.innerWidth/2+400+"px",t}static createAsteroid(e,t){const i=l.appendElement(c,"img","rotating-element",null,{src:`./images/asteroids/asteroid${Math.round(s.rng(1,4))}.png`});return i.style.position="absolute",i.style.height=t+"px",i.style.top=e+"px",i.style.left=window.innerWidth+100+"px",i}}class x{constructor(e,t,i,n,r,a){o(this,"_element");o(this,"style");o(this,"_width");o(this,"_height");o(this,"_hp");o(this,"_shotManager");o(this,"_shipManager");o(this,"verticalSpeed");o(this,"isDown");this._element=e,this.style=e.style,this._width=t,this._height=i,this._hp=n,this.verticalSpeed=r??0,this.isDown=a??!1}getVerticalPosition(){return s.positionToNumber(this.style.top)}getHorizontalPosition(){return s.positionToNumber(this.style.left)}get width(){return this._width}get height(){return this._height}getHit(){this._hp--,this._hp===0&&this.die()}setShotManager(e){this._shotManager||(this._shotManager=e)}setShipManager(e){this._shipManager||(this._shipManager=e)}get hp(){return this._hp}get element(){return this._element}bounceVertically(){this.isDown&&(this.style.top=s.positionToNumber(this.style.top)+(this.verticalSpeed??0)+"px",s.positionToNumber(this.style.top)>window.innerHeight-50&&(this.isDown=!1)),this.isDown||(this.style.top=s.positionToNumber(this.style.top)-(this.verticalSpeed??0)+"px",s.positionToNumber(this.style.top)<0&&(this.isDown=!0))}}class O{static bottomBorder(e){return Number(e.top.split("p")[0])<window.innerHeight-100}static topBorder(e){return Number(e.top.split("p")[0])>30}static rightBorder(e){return Number(e.left.split("p")[0])<window.innerWidth-200}static leftBorder(e){return Number(e.left.split("p")[0])>0}}class T{static createDeathLaserHtml(){const e=l.appendElement(c,"img","dsLaser",null,{src:"./images/laser6.png"});return e.style.display="none",e.style.position="fixed",e.style.width="1820px",e.style.right="35px",e}static createXWingShot(e,t){const i=l.appendElement(c,"img","shot",null,{src:"./images/shot.png",id:t});return i.style.zIndex="3",i.style.position="absolute",i.style.width="10px",i.style.top=s.positionToNumber(e.top)+44+"px",i.style.left=s.positionToNumber(e.left)+50+"px",i}static createDeathstarBang(e){const t=l.appendElement(c,"img",null,null,{src:"./images/explosion.gif"});return t.style.width="150px",t.style.position="absolute",t.style.top=e.style.top,t.style.left=s.positionToNumber(e.style.left)+"px",t}static createBang(e){const t=l.appendElement(c,"img",null,null,{src:"./images/explosion.gif"});return t.style.width="50px",t.style.position="absolute",t.style.top=e.style.top,t.style.left=s.positionToNumber(e.style.left)+"px",setTimeout(()=>{t.remove()},500),t}static createBang2(e){const t=l.appendElement(c,"img",null,null,{src:"./images/asteroids/explosion.gif"});return t.style.width="200px",t.style.position="absolute",t.style.top=e.style.top,t.style.left=s.positionToNumber(e.style.left)+"px",setTimeout(()=>{t.remove()},500),t}static createTieShot(e){const t=l.appendElement(c,"img","tieShot",null,{src:"./images/TIEshot.png"});return t.style.position="absolute",t.style.height="5px",t.style.top=s.positionToNumber(e.style.top)+s.positionToNumber(e.style.height)/2+"px",t.style.left=s.positionToNumber(e.style.left)+s.positionToNumber(e.style.width)+"px",t}static createBlasterShot(e){const t=l.appendElement(c,"img","tieShot",null,{src:"./images/TIEshot.png"});return t.style.position="absolute",t.style.height="10px",t.style.top=s.positionToNumber(e.style.top)+30+"px",t.style.left=s.positionToNumber(e.style.left)+15+"px",t}static createSithFighterShot(e){const t=l.appendElement(c,"img","tieShot",null,{src:"./images/TIEshot.png"});return t.style.position="absolute",t.style.height="5px",t.style.top=s.positionToNumber(e.style.top)+10+"px",t.style.left=s.positionToNumber(e.style.left)+45+"px",t}static createMissile(e){const t=l.appendElement(c,"img","rocket",null,{src:"./images/rocket.png"});return t.style.height="8px",t.style.position="fixed",t.style.top=s.positionToNumber(e.style.top)+55+"px",t.style.left=s.positionToNumber(e.style.left)+40+"px",t}static createTractorBeam(e){let t=l.appendElement(c,"img","beam",null,{src:"./images/beam2.png"});return t.style.width="1000px",t.style.position="fixed",t.style.display="none",t.style.top=s.positionToNumber(e.style.top)-400+"px",t.style.left=s.positionToNumber(e.style.left)-700+"px",t}static createKamikazeDrone(e){let t=l.appendElement(c,"img","drone",null,{src:"./images/drone4.gif"});return t.style.width="15px",t.style.position="fixed",t.style.top=s.positionToNumber(e.style.top)+40+"px",t.style.left=s.positionToNumber(e.style.left)+30+"px",t}static createVortex1(e){let t=l.appendElement(c,"img","drone",null,{src:"./images/teleport2.gif"});return t.style.zIndex="1",t.style.display="none",t.style.width="200px",t.style.position="fixed",t.style.top=s.positionToNumber(e.style.top)-85+"px",t.style.left=s.positionToNumber(e.style.left)-50+"px",t}static createVortex2(e){let t=l.appendElement(c,"img","drone",null,{src:"./images/teleport1reverse.gif"});return t.style.display="none",t.classList.add("opaque"),t.style.transform="rotate(90deg)",t.style.width="100px",t.style.position="fixed",t.style.top=s.positionToNumber(e.style.top)-60+"px",t.style.left=s.positionToNumber(e.style.left)+"px",t}}class D{constructor(e,t=30){o(this,"_element");o(this,"lastTime");o(this,"explosionSize");this._element=e,this.lastTime=0,this.explosionSize=t}get element(){return this._element}getVerticalPosition(){return s.positionToNumber(this.element.style.top)}modifyTop(e){this.element.style.top=s.positionToNumber(this.element.style.top)+e+"px"}modifyLeft(e){this.element.style.left=s.positionToNumber(this.element.style.left)+e+"px"}getHorizontalPosition(){return s.positionToNumber(this.element.style.left)}hit(){const e=this._element;e.src="./images/explosion.gif",setTimeout(()=>{this._element.style.top=s.positionToNumber(this._element.style.top)-10+"px",this._element.style.left=s.positionToNumber(this._element.style.left)-10+"px",this._element.style.width=this.explosionSize+"px",this._element.style.height=this.explosionSize+"px"},10),setTimeout(()=>{this._element.remove()},500)}}const z=class z extends D{constructor(e){super(e)}fly(e){s.isTimeTo(e,1,this.lastTime,1)&&(this.lastTime=s.convertTime(e,1),this.element.style.left=s.positionToNumber(this.element.style.left)+z.SPEED+"px",s.positionToNumber(this.element.style.left)>window.innerWidth-10&&this.element.remove())}};o(z,"SPEED",10);let W=z;class E{static createInfoBar(e){const t=l.appendElement(c,"div","infobar",null,{id:"infobar"});l.appendElement(t,"div","lives",null,{id:"lives"}),l.appendElement(t,"div","score-display",null,{id:"score"}),E.displayLives(e),E.updateScore(0)}static displayLives(e){const t=document.getElementById("lives");for(let i=0;i<e;i++)l.appendElement(t,"img","life",null,{src:"./images/Luke.png"})}static refreshLives(e){E.clearLives(),E.displayLives(e)}static clearLives(){Array.from(document.getElementsByClassName("life")).forEach(t=>{t.remove()})}static startHitPulse(){const e=document.getElementById("lives");e&&e.classList.add("active")}static stopHitPulse(){const e=document.getElementById("lives");e&&e.classList.remove("active")}static updateScore(e){const t=document.getElementById("score");t&&(t.textContent=`Score: ${e}`)}}const m=class m extends x{constructor(t,i,n){super(t,m._WIDTH,m._HEIGHT,i);o(this,"eventHandler");o(this,"isInvincible");o(this,"lastTime");o(this,"scoringManager");this.eventHandler=n,this.isInvincible=!1,this.lastTime=0,n.handleKeys()}handleXWing(t){this.move(),this.shoot(t)}shoot(t){this.eventHandler.shoot&&Math.round(t/m.TIME_DIVIDER)%m.SHOOT_INTERVAL===0&&Math.round(this.lastTime/m.TIME_DIVIDER)!==Math.round(t/m.TIME_DIVIDER)&&(this.lastTime=t,this.createShot(t))}move(){this.eventHandler.up&&O.topBorder(this.style)&&(this.style.top=s.positionToNumber(this.style.top)-m.SPEED+"px"),this.eventHandler.down&&O.bottomBorder(this.style)&&(this.style.top=s.positionToNumber(this.style.top)+m.SPEED+"px"),this.eventHandler.left&&O.leftBorder(this.style)&&(this.style.left=s.positionToNumber(this.style.left)-m.SPEED+"px"),this.eventHandler.right&&O.rightBorder(this.style)&&(this.style.left=s.positionToNumber(this.style.left)+m.SPEED+"px")}createShot(t){const i=T.createXWingShot(this.style,t),n=new W(i);return this._shotManager.registerPlayerShot(n),n}die(){var i;const t=((i=this.scoringManager)==null?void 0:i.getScore())??0;s.gameOver(t)}setScoringManager(t){this.scoringManager=t}getHit(){this.isInvincible||(super.getHit(),this.hitPulse(),E.refreshLives(this.hp))}hitPulse(){E.startHitPulse(),this.element.classList.add("active"),setTimeout(()=>{this.element.classList.remove("active"),E.stopHitPulse()},500)}getPulled(t,i){this.element.style.top=s.positionToNumber(this.element.style.top)+t+"px",this.element.style.left=s.positionToNumber(this.element.style.left)+i+"px"}};o(m,"TIME_DIVIDER",25),o(m,"SHOOT_INTERVAL",4),o(m,"_HEIGHT",75),o(m,"_WIDTH",10),o(m,"SPEED",8);let H=m;class _{static show(){this.selectedButton=0,this.overlay=l.appendElement(c,"div",null,null,{id:"restart-confirmation"});const e=l.appendElement(this.overlay,"div",null,null,{id:"restart-confirmation-box"});l.appendElement(e,"div",null,null,{id:"restart-confirmation-text"}).textContent="Restart Game?";const t=l.appendElement(e,"div",null,null,{id:"restart-confirmation-buttons"});this.confirmBtn=l.appendElement(t,"button",null,null,{id:"confirm-restart",class:"restart-confirmation-btn"}),this.confirmBtn.textContent="YES",this.confirmBtn.addEventListener("click",()=>{window.location.reload()}),this.cancelBtn=l.appendElement(t,"button",null,null,{id:"cancel-restart",class:"restart-confirmation-btn"}),this.cancelBtn.textContent="NO",this.cancelBtn.addEventListener("click",()=>{this.close()}),this.updateButtonSelection(),window.addEventListener("keydown",this.handleKeyboardInput.bind(this))}static updateButtonSelection(){this.confirmBtn.classList.remove("selected"),this.cancelBtn.classList.remove("selected"),this.selectedButton===0?this.confirmBtn.classList.add("selected"):this.cancelBtn.classList.add("selected")}static handleKeyboardInput(e){e.key==="ArrowLeft"||e.key==="ArrowRight"?(this.selectedButton=this.selectedButton===0?1:0,this.updateButtonSelection()):e.key==="Enter"&&(this.selectedButton===0?window.location.reload():this.close())}static close(){window.removeEventListener("keydown",this.handleKeyboardInput.bind(this)),this.overlay.remove()}}o(_,"selectedButton",0),o(_,"confirmBtn"),o(_,"cancelBtn"),o(_,"overlay");class j{constructor(){o(this,"_up");o(this,"_down");o(this,"_left");o(this,"_right");o(this,"_shoot");this._down=!1,this._up=!1,this._left=!1,this._right=!1,this._shoot=!1}handleKeys(){window.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("keyup",this.handleKeyUp.bind(this))}handleKeyDown(e){e.key==="ArrowDown"&&(this._down=!0),e.key==="ArrowUp"&&(this._up=!0),e.key==="ArrowLeft"&&(this._left=!0),e.key==="ArrowRight"&&(this._right=!0),e.key==="s"&&(this._shoot=!0),(e.key==="r"||e.key==="R")&&_.show()}handleKeyUp(e){e.key==="ArrowDown"&&(this._down=!1),e.key==="ArrowUp"&&(this._up=!1),e.key==="ArrowLeft"&&(this._left=!1),e.key==="ArrowRight"&&(this._right=!1),e.key==="s"&&(this._shoot=!1)}get up(){return this._up}get down(){return this._down}get left(){return this._left}get right(){return this._right}get shoot(){return this._shoot}}class I{constructor(e){o(this,"shipManager");this.shipManager=e}}const k=class k extends D{constructor(e){super(e)}fly(e){s.isTimeTo(e,1,this.lastTime,1)&&(this.lastTime=s.convertTime(e,1),this.element.style.left=s.positionToNumber(this.element.style.left)-k.SPEED+"px",s.positionToNumber(this.element.style.left)<-10&&this.element.remove())}};o(k,"SPEED",10);let X=k;const d=class d extends x{constructor(t,i=!0,n=d.HORIZONTAL_SPEED){super(t,d.WIDTH,d.HEIGHT,d.HP,d.VERTICAL_SPEED,i);o(this,"speedLeft");o(this,"lastShotTime");this.speedLeft=n,this.lastShotTime=0}die(){this._shipManager.removeShip(this);const t=this.element;t.src="./images/explosion.gif",this.element.style.width="30px",setTimeout(()=>{this.element.remove()},500)}moveLeft(){this.style.left=s.positionToNumber(this.style.left)-this.speedLeft+"px",this.disappear()}disappear(){s.positionToNumber(this.style.left)<d.LEFT_POSITION_OF_DISAPPEARANCE&&(this.element.remove(),this._shipManager.removeShip(this))}move(){this.bounceVertically(),this.moveLeft()}shoot(t){if(s.isTimeTo(t,10,this.lastShotTime)&&this._shotManager){const i=T.createTieShot(this.element);this.lastShotTime=s.convertTime(t);const n=new X(i);this._shotManager.registerShot(n)}}};o(d,"HP",1),o(d,"WIDTH",20),o(d,"HEIGHT",40),o(d,"VERTICAL_SPEED",3),o(d,"HORIZONTAL_SPEED",3),o(d,"LEFT_POSITION_OF_DISAPPEARANCE",-50);let V=d;class N{constructor(){o(this,"lastTime",0)}shouldFire(e,t){const i=Math.round(e/100);return i===t&&i!==this.lastTime?(this.lastTime=i,!0):!1}}class J extends I{constructor(){super(...arguments);o(this,"scheduler",new N)}create(t,i,n){if(this.scheduler.shouldFire(n,t)){const r=new V(w.createTieFighter(i));this.shipManager.addShip(r)}}}const g=class g extends x{constructor(t){super(t,g.WIDTH,g.HEIGHT,g.HP,g.INITIAL_SPEED,!0);o(this,"laser");o(this,"_isLaserActive");o(this,"_isDead");this.laser=T.createDeathLaserHtml(),this._isLaserActive=!1,this._isDead=!1}moveDown(){this.isDown&&(this.style.top=s.positionToNumber(this.style.top)+(this.verticalSpeed??0)+"px",s.positionToNumber(this.style.top)>window.innerHeight-200&&(this.isDown=!1,this.verticalSpeed=s.rng(1,3)))}moveUp(){this.isDown||(this.style.top=s.positionToNumber(this.style.top)-(this.verticalSpeed??0)+"px",s.positionToNumber(this.style.top)<0&&(this.isDown=!0,this.verticalSpeed=s.rng(1,3)))}slideIn(){s.positionToNumber(this.style.left)>g.REST_POSITION&&(this.style.left=s.positionToNumber(this.style.left)-g.SLIDE_SPEED+"px")}move(){this._isDead||(this.slideIn(),this.moveDown(),this.moveUp())}shoot(t){this.laser.style.top=s.positionToNumber(this.element.style.top)-105+"px",s.isTimeTo(t,30)&&(this.laser.style.display="block",this._isLaserActive=!0),s.isTimeTo(t,60)&&(this.laser.style.display="none",this._isLaserActive=!1)}die(){this._shipManager.removeShip(this),this._isDead=!0,this.laser.remove();const t=this.element;t.src="./images/deathstar-ruin.png";const i=T.createDeathstarBang(this.element);this.element.classList.add("active"),setTimeout(()=>{i.remove(),this.element.remove()},5e3)}get isLaserActive(){return this._isLaserActive}getLaserTop(){return s.positionToNumber(this.laser.style.top)}};o(g,"HEIGHT",200),o(g,"WIDTH",-20),o(g,"HP",50),o(g,"INITIAL_SPEED",2),o(g,"SLIDE_SPEED",10),o(g,"REST_POSITION",window.innerWidth-220);let A=g;class Q extends I{constructor(){super(...arguments);o(this,"scheduler",new N)}create(t,i){if(this.scheduler.shouldFire(i,t)){const n=new A(w.createDeathStarHtml());this.shipManager.addShip(n)}}}const C=class C extends D{constructor(t){super(t);o(this,"speed");o(this,"speedModifier1");o(this,"speedModifier2");this.speed=C.INITIAL_SPEED,this.speedModifier1=1.00000000000001,this.speedModifier2=1.01}fly(t){s.isTimeTo(t,1,this.lastTime,1)&&(this.speedModifier1=this.speedModifier1*this.speedModifier2,this.lastTime=s.convertTime(t,1),this.element.style.left=s.positionToNumber(this.element.style.left)-this.speed*this.speedModifier1+"px",s.positionToNumber(this.element.style.left)<-10&&this.element.remove())}homing(t){this.getVerticalPosition()>t+40?this.modifyTop(-1.5):this.modifyTop(1.5)}};o(C,"INITIAL_SPEED",3);let F=C;const S=class S extends x{constructor(t,i=!0,n=1){super(t,S.WIDTH,S.HEIGHT,S.HP,S.VERTICAL_SPEED,i);o(this,"lastShotTime");o(this,"angle");o(this,"angleModifier");o(this,"stepSize");this.lastShotTime=0,this.angle=0,this.stepSize=2,this.angleModifier=n}die(){this._shipManager.removeShip(this);const t=this.element;t.src="./images/explosion.gif",this.element.style.width="100px",this.element.style.height="100px",setTimeout(()=>{this.element.remove()},500)}moveDown(t){s.positionToNumber(this.style.top)<window.innerHeight-50&&(this.style.top=s.positionToNumber(this.style.top)+t+"px")}moveUp(t){s.positionToNumber(this.style.top)>30&&(this.style.top=s.positionToNumber(this.style.top)-t+"px")}moveLeft(t){this.style.left=s.positionToNumber(this.style.left)-t+"px",this.disappear()}moveRight(t){this.style.left=s.positionToNumber(this.style.left)+t+"px"}disappear(){s.positionToNumber(this.style.left)<S.LEFT_POSITION_OF_DISAPPEARANCE&&(this.element.remove(),this._shipManager.removeShip(this))}move(){this.moveLeft(1);const t=this.angle*(Math.PI/180),i=Math.cos(t)*this.stepSize,n=Math.sin(t)*this.stepSize;i>0?this.moveRight(i):this.moveLeft(-i),n>0?this.moveDown(n):this.moveUp(-n),this.angle+=this.angleModifier,this.angle>=360&&(this.angle=0)}shoot(t){if(s.isTimeTo(t,30,this.lastShotTime)&&this._shotManager){const i=T.createMissile(this.element);this.lastShotTime=s.convertTime(t);const n=new F(i);this._shotManager.registerShot(n)}}};o(S,"HP",20),o(S,"WIDTH",0),o(S,"HEIGHT",60),o(S,"VERTICAL_SPEED",3),o(S,"LEFT_POSITION_OF_DISAPPEARANCE",-100);let B=S;class tt extends I{constructor(){super(...arguments);o(this,"scheduler",new N)}create(t,i,n,r){if(this.scheduler.shouldFire(n,t)){const a=new B(w.createShuttle(i),!0,r);this.shipManager.addShip(a)}}}class G{static aimVector(e,t,i,n,r=10){const a=e-i,p=t-n,v=Math.abs(a)+Math.abs(p),L=a<0?Math.abs(a)/v*-r:Math.abs(a)/v*r,$=p<0?Math.abs(p)/v*-r:Math.abs(p)/v*r;return[L,$]}}class et{constructor(e){o(this,"lastTime");o(this,"_element");o(this,"isBeamOn");this._element=e,this.lastTime=0,this.isBeamOn=!1}handle(e,t,i,n){s.isTimeTo(e,t,this.lastTime)&&(this._element.style.display="none",this.isBeamOn=!1),s.isTimeTo(e,i,this.lastTime)&&(this._element.style.display="block",this.isBeamOn=!0),this.isBeamOn&&this.pullXWing(n)}pullXWing(e){e.getVerticalPosition()>s.positionToNumber(this.element.style.top)+400&&e.getPulled(-2,0),e.getVerticalPosition()<s.positionToNumber(this.element.style.top)+400&&e.getPulled(2,0),e.getHorizontalPosition()>s.positionToNumber(this.element.style.left)+800&&e.getPulled(0,-2),e.getHorizontalPosition()<s.positionToNumber(this.element.style.left)+800&&e.getPulled(0,2)}updatePosition(e,t){this._element.style.left=t-700+"px",this._element.style.top=e-400+"px"}get element(){return this._element}}class U extends D{constructor(t,i,n){super(t);o(this,"distance");o(this,"isUp");this.isUp=n,this.distance=n?10:-10}fly(t){s.isTimeTo(t,1,this.lastTime,1)&&this.distance&&(this.distance=this.distance*.96,this.distance<.05&&this.isUp&&(this.distance=0),this.distance>-.05&&!this.isUp&&(this.distance=0),this.lastTime=s.convertTime(t,1),this.element.style.top=s.positionToNumber(this.element.style.top)-this.distance+"px")}homing(t,i){this.getVerticalPosition()>t+30?this.modifyTop(-1):this.modifyTop(1),this.getHorizontalPosition()>i+10?this.modifyLeft(-1):this.modifyLeft(1)}}class K extends D{constructor(t,i=0,n=10){super(t);o(this,"verticalVelocity");o(this,"horizontalVelocity");this.verticalVelocity=i,this.horizontalVelocity=n}fly(t){s.isTimeTo(t,1,this.lastTime,1)&&(this.lastTime=s.convertTime(t,1),this.element.style.left=s.positionToNumber(this.element.style.left)-this.horizontalVelocity+"px",this.element.style.top=s.positionToNumber(this.element.style.top)-this.verticalVelocity+"px",s.positionToNumber(this.element.style.left)<-10&&this.element.remove())}}const u=class u extends x{constructor(t,i=!0,n=u.HORIZONTAL_SPEED){super(t,u.WIDTH,u.HEIGHT,u.HP,u.VERTICAL_SPEED,i);o(this,"speedLeft");o(this,"lastDroneTime");o(this,"lastShotTime");o(this,"beam");o(this,"isDroneUp");this.speedLeft=n,this.lastDroneTime=0,this.lastShotTime=0,this.beam=new et(T.createTractorBeam(this.element)),this.isDroneUp=!0}die(){this._shipManager.removeShip(this);const t=this.element;t.src="./images/explosion.gif",this.element.style.width="200px",this.element.style.height="200px",setTimeout(()=>{this.element.remove(),this.beam.element.remove()},500)}moveLeft(){s.positionToNumber(this.style.left)>window.innerWidth/1.5&&(this.style.left=s.positionToNumber(this.style.left)-this.speedLeft+"px",this.disappear())}disappear(){s.positionToNumber(this.style.left)<u.LEFT_POSITION_OF_DISAPPEARANCE&&(this.element.remove(),this._shipManager.removeShip(this))}move(){this.bounceVertically(),this.moveLeft(),this.beam.updatePosition(s.positionToNumber(this.element.style.top),s.positionToNumber(this.element.style.left))}deployDrones(t){if(s.isTimeTo(t,10,this.lastDroneTime)&&this._shotManager){this.isDroneUp?this.isDroneUp=!1:this.isDroneUp=!0;const i=T.createKamikazeDrone(this.element);this.lastDroneTime=s.convertTime(t);const n=new U(i,this._shipManager.getXWing(),this.isDroneUp);this._shotManager.registerShot(n)}}useTractorBeam(t){this._shipManager&&this.beam.handle(t,20,40,this._shipManager.getXWing())}shootSniperBlaster(t){if(s.isTimeTo(t,10,this.lastShotTime)&&this._shipManager&&this._shotManager){this.lastShotTime=s.convertTime(t);const i=T.createBlasterShot(this.element),[n,r]=G.aimVector(this.getVerticalPosition(),this.getHorizontalPosition(),this._shipManager.getXWing().getVerticalPosition(),this._shipManager.getXWing().getHorizontalPosition());let a=0;const p=this.getHorizontalPosition()-this._shipManager.getXWing().getHorizontalPosition();p>0?a=n*9:p<0&&(a=n*-9+180),i.style.transform=`rotate(${a}deg)`;const v=new K(i,n,r);this._shotManager.registerShot(v)}}shoot(t){this.useTractorBeam(t),this.deployDrones(t),this.shootSniperBlaster(t)}};o(u,"HP",50),o(u,"WIDTH",-200),o(u,"HEIGHT",90),o(u,"VERTICAL_SPEED",1),o(u,"HORIZONTAL_SPEED",30),o(u,"LEFT_POSITION_OF_DISAPPEARANCE",-50);let R=u;class it extends I{constructor(){super(...arguments);o(this,"scheduler",new N)}create(t,i,n){if(this.scheduler.shouldFire(n,t)){const r=new R(w.createStarDestroyer(i));this.shipManager.addShip(r)}}}const y=class y extends x{constructor(t,i=!0,n=y.HORIZONTAL_SPEED){super(t,y.WIDTH,y.HEIGHT,y.HP,y.VERTICAL_SPEED,i);o(this,"lastShotTime");o(this,"isVortexOn");o(this,"isTeleportOn");o(this,"vortex1");o(this,"vortex2");this.lastShotTime=0,this.isVortexOn=!1,this.isTeleportOn=!0,this.vortex1=T.createVortex1(this.element),this.vortex2=T.createVortex2(this.element)}rotateShip(){if(this._shipManager){const[t,i]=G.aimVector(this.getVerticalPosition(),this.getHorizontalPosition(),this._shipManager.getXWing().getVerticalPosition(),this._shipManager.getXWing().getHorizontalPosition()),n=Math.atan2(t,i)*180/Math.PI;this.element.style.transform=`rotate(${n}deg)`}}die(){this._shipManager.removeShip(this);const t=this.element;t.src="./images/explosion.gif",this.element.style.width="100px",this.element.style.height="100px",setTimeout(()=>{this.element.remove(),"triggerVictory"in this._shipManager&&this._shipManager.triggerVictory()},500)}vortexAppear(){this.isVortexOn=!0,this.vortex1.classList.add("fade-in"),this.vortex1.style.display="block"}vortexCollapse(){this.vortex1.classList.add("collapse"),this.element.classList.add("collapse-ship"),this.vortex1.classList.remove("fade-in")}shipReappear(){this.vortex1.style.display="none",this.vortex1.classList.remove("collapse"),this.element.classList.remove("collapse-ship"),this.vortex1.classList.add("fade-in"),this.element.classList.add("fade-in-again"),this.vortex2.style.display="block",setTimeout(()=>{this.vortex2.style.display="none"},650)}endTeleportSequence(){this.vortex1.classList.remove("fade-in"),this.element.classList.remove("fade-in-again"),this.isVortexOn=!1}setNewPositionForShip(){let t=s.rng(100,window.innerHeight-100);for(;t<s.positionToNumber(this.element.style.top)+200&&t>s.positionToNumber(this.element.style.top)-200;)t=s.rng(100,window.innerHeight-100);this.element.style.top=t+"px",this.vortex1.style.top=s.positionToNumber(this.element.style.top)-85+"px",this.vortex1.style.left=s.positionToNumber(this.element.style.left)-50+"px",this.vortex2.style.top=s.positionToNumber(this.element.style.top)-60+"px",this.vortex2.style.left=s.positionToNumber(this.element.style.left)+"px"}teleport(){this._shipManager&&this._shipManager.getXWing().getVerticalPosition()>this.getVerticalPosition()-50&&this._shipManager.getXWing().getVerticalPosition()<this.getVerticalPosition()+50&&!this.isVortexOn&&(this.vortexAppear(),setTimeout(()=>{this.vortexCollapse(),setTimeout(()=>{this.setNewPositionForShip(),this.shipReappear(),setTimeout(()=>{this.endTeleportSequence(),this.isTeleportOn=!0},1e3)},1e3)},3e3),setTimeout(()=>{this.isTeleportOn=!1},2500))}move(){this.rotateShip(),this.teleport()}shoot(t){if(s.isTimeTo(t,1,this.lastShotTime)&&this._shipManager&&this._shotManager&&this.isTeleportOn){this.lastShotTime=s.convertTime(t);const i=T.createSithFighterShot(this.element),[n,r]=G.aimVector(this.getVerticalPosition(),this.getHorizontalPosition(),this._shipManager.getXWing().getVerticalPosition(),this._shipManager.getXWing().getHorizontalPosition()),a=Math.atan2(n,r)*180/Math.PI;i.style.transform=`rotate(${a}deg)`;const p=new K(i,n-y.AIM_VERTICAL_OFFSET,r);this._shotManager.registerShot(p)}}getHit(){this.isTeleportOn||super.getHit()}};o(y,"HP",40),o(y,"WIDTH",-15),o(y,"HEIGHT",35),o(y,"VERTICAL_SPEED",3),o(y,"HORIZONTAL_SPEED",3),o(y,"AIM_VERTICAL_OFFSET",.15);let M=y;class st extends I{constructor(){super(...arguments);o(this,"scheduler",new N)}create(t,i,n){if(this.scheduler.shouldFire(n,t)){const r=new M(w.createSithFighter(i));this.shipManager.addShip(r)}}}const f=class f extends x{constructor(t,i,n,r){super(t,f.WIDTH*r,f._HEIGHT_TO_HP_RATIO*r,r,n,!0);o(this,"horizontalSpeed");o(this,"startingHp");this.horizontalSpeed=i,this.startingHp=r}static get HEIGHT_TO_HP_RATIO(){return this._HEIGHT_TO_HP_RATIO}die(){this.createFragments(),T.createBang(this.element),this._shipManager.removeShip(this),this.element.remove()}createFragments(){if(this.startingHp>1)for(let t=0;t<s.rng(3,6);t++){const i=Math.max(1,Math.round(s.rng(1,this.startingHp/2))),n=s.positionToNumber(this.element.style.top),r=w.createAsteroid(n,i*f._HEIGHT_TO_HP_RATIO);r.style.left=this.element.style.left;const a=1,p=s.rng(-1,2*a+this.horizontalSpeed),v=s.rng(-1*a,a),L=new f(r,p,v,i);L.setShipManager(this._shipManager),this._shipManager.addShip(L)}}moveVertical(){this.style.top=s.positionToNumber(this.style.top)+(this.verticalSpeed??0)+"px",s.positionToNumber(this.style.top)>window.innerHeight-50&&(this.isDown=!1)}moveLeft(){this.style.left=s.positionToNumber(this.style.left)-this.horizontalSpeed+"px"}disappear(){s.positionToNumber(this.style.left)<f.LEFT_POSITION_OF_DISAPPEARANCE&&(this.element.remove(),this._shipManager.removeShip(this)),(s.positionToNumber(this.style.top)<f.TOP_POSITION_OF_DISAPPEARANCE||s.positionToNumber(this.style.top)>window.innerHeight-f.TOP_POSITION_OF_DISAPPEARANCE)&&(this.element.remove(),this._shipManager.removeShip(this))}move(){this.moveVertical(),this.moveLeft(),this.disappear()}shoot(){}};o(f,"WIDTH",-2),o(f,"_HEIGHT_TO_HP_RATIO",20),o(f,"LEFT_POSITION_OF_DISAPPEARANCE",-400),o(f,"TOP_POSITION_OF_DISAPPEARANCE",-400);let b=f;class ot extends I{constructor(){super(...arguments);o(this,"scheduler",new N)}create(t,i,n,r){if(this.scheduler.shouldFire(n,t)){const a=w.createAsteroid(i,r*b.HEIGHT_TO_HP_RATIO),p=new b(a,s.rng(2,5),s.rng(-1,1),r);this.shipManager.addShip(p)}}}class nt{constructor(){o(this,"tieAssembler");o(this,"deathstarAssembler");o(this,"shuttleAssembler");o(this,"starDestroyerAssembler");o(this,"sithFighterAssembler");o(this,"asteroidAssembler")}setShipManager(e){this.tieAssembler=new J(e),this.deathstarAssembler=new Q(e),this.shuttleAssembler=new tt(e),this.starDestroyerAssembler=new it(e),this.sithFighterAssembler=new st(e),this.asteroidAssembler=new ot(e)}createTieFighter(e,t,i){this.tieAssembler.create(e,t,i)}createTieSwarm(e,t,i,n,r){for(let a=0;a<n;a++)this.tieAssembler.create(e+r*a,t,i)}createDeathStar(e,t){this.deathstarAssembler.create(e,t)}createShuttle(e,t,i,n){this.shuttleAssembler.create(e,t,i,n)}createStarDestroyer(e,t,i){this.starDestroyerAssembler.create(e,t,i)}createSithFighter(e,t,i){this.sithFighterAssembler.create(e,t,i)}createAsteroid(e,t,i,n){this.asteroidAssembler.create(e,t,i,n)}generateAsteroids(e,t,i,n){for(let r=0;r<t;r++){const a=Math.round(s.rng(1,8)),p=window.innerHeight/8*s.rng(1,7);this.createAsteroid(e+r*i,p,n,a)}}}class P{static isEnemyHit(e,t){return t.getHorizontalPosition()>e.getHorizontalPosition()-e.width&&t.getHorizontalPosition()<e.getHorizontalPosition()-e.width+50&&t.getVerticalPosition()>e.getVerticalPosition()&&t.getVerticalPosition()<e.getVerticalPosition()+e.height}static isKamikazeDroneHit(e,t){return t.getHorizontalPosition()>e.getHorizontalPosition()&&t.getHorizontalPosition()<e.getHorizontalPosition()+30&&t.getVerticalPosition()>e.getVerticalPosition()&&t.getVerticalPosition()<e.getVerticalPosition()+10}static isPlayerHitByLaser(e,t){return e&&e.isLaserActive&&e.getLaserTop()>t.getVerticalPosition()-160&&e.getLaserTop()<t.getVerticalPosition()-100}static isPlayerHitByShot(e,t){return e.getHorizontalPosition()<t.getHorizontalPosition()+t.width*2&&e.getHorizontalPosition()>t.getHorizontalPosition()-t.width/2&&e.getVerticalPosition()<t.getVerticalPosition()+t.height&&e.getVerticalPosition()>t.getVerticalPosition()}static isCrashed(e,t){return e.getHorizontalPosition()<t.getHorizontalPosition()+t.width&&e.getHorizontalPosition()>t.getHorizontalPosition()-e.width&&e.getVerticalPosition()<t.getVerticalPosition()+t.height&&e.getVerticalPosition()>t.getVerticalPosition()-e.height}static isTimeToShoot(e,t,i){return e&&Math.round(t/H.TIME_DIVIDER)%H.SHOOT_INTERVAL===0&&Math.round(i/H.TIME_DIVIDER)!==Math.round(t/H.TIME_DIVIDER)}}class rt{constructor(){o(this,"shotManager");o(this,"shipManager");o(this,"scoringManager")}setUp(e,t,i){this.shotManager=e,this.shipManager=t,this.scoringManager=i}getShipDestructionPoints(e){return e instanceof V?10:e instanceof B?50:e instanceof R?200:e instanceof A?1e3:e instanceof M?2e3:(e instanceof b,0)}checkHitsOnEnemy(){this.shotManager.getPlayerShots().forEach(e=>{this.shipManager.getShips().forEach(t=>{if(P.isEnemyHit(t,e)){e.hit(),this.scoringManager.addScore(10);const i=t.hp>0;t.getHit(),i&&t.hp===0&&this.scoringManager.addScore(this.getShipDestructionPoints(t)),this.shotManager.setPlayerShots(this.shotManager.getPlayerShots().filter(n=>n!==e))}}),this.shotManager.getShots().filter(t=>t instanceof U).forEach(t=>{const i=t;P.isKamikazeDroneHit(i,e)&&(e.hit(),i.hit(),this.scoringManager.addScore(10),this.shotManager.setPlayerShots(this.shotManager.getPlayerShots().filter(n=>n!==e)),i.element.remove(),this.shotManager.removeShot(i))})})}checkDeathLaserHit(){const e=this.shipManager.getShips().filter(t=>t instanceof A)[0];if(P.isPlayerHitByLaser(e,this.shipManager.getXWing())){const t=T.createBang(this.shipManager.getXWing().element);t.style.top=e.getLaserTop()+150+"px",this.shipManager.getXWing().getHit()}}checkEnemyShotHits(){this.shotManager.getShots().forEach(e=>{P.isPlayerHitByShot(e,this.shipManager.getXWing())&&(this.shipManager.getXWing().getHit(),e.hit(),this.shotManager.removeShot(e))})}checkCrashes(){this.shipManager.getShips().forEach(e=>{P.isCrashed(e,this.shipManager.getXWing())&&(this.shipManager.getXWing().getHit(),e.getHit())})}checkAsteroidHitsOnEnemies(){this.shipManager.getShips().filter(e=>e instanceof b).forEach(e=>{const t=e;this.shipManager.getShips().filter(i=>!(i instanceof b)).forEach(i=>{P.isCrashed(i,t)&&(t.getHit(),i.getHit())})})}checkHitsOnPlayer(){this.checkDeathLaserHit(),this.checkEnemyShotHits()}checkForHits(){this.checkAsteroidHitsOnEnemies(),this.checkCrashes(),this.checkHitsOnEnemy(),this.checkHitsOnPlayer()}}class lt{constructor(){o(this,"_shipManager")}setShipManager(e){this._shipManager=e}act(e){this._shipManager.getShips().forEach(t=>{t.move(),t.shoot(e)})}}class ht{constructor(){o(this,"_shotManager");o(this,"_shipManager")}setUp(e,t){this._shotManager=e,this._shipManager=t}moveShots(e){this._shotManager.getShots().forEach(t=>t.fly(e)),this._shotManager.getPlayerShots().forEach(t=>t.fly(e)),this._shotManager.setPlayerShots(this._shotManager.getPlayerShots().filter(t=>t.element.isConnected)),this._shotManager.getShots().filter(t=>t instanceof F||t instanceof U).forEach(t=>t.homing(this._shipManager.getXWing().getVerticalPosition(),this._shipManager.getXWing().getHorizontalPosition()))}}class at{static show(e){const t=l.appendElement(c,"div",null,null,{id:"victory-overlay"}),i=l.appendElement(t,"div",null,null,{id:"victory-container"});l.appendElement(i,"div",null,null,{id:"victory-title"}).textContent="VICTORY!",l.appendElement(i,"div",null,null,{id:"victory-message"}).textContent="The Rebels Won!",l.appendElement(i,"div",null,null,{id:"victory-subtitle"}).textContent="The Emperor has been defeated...",l.appendElement(i,"div",null,null,{id:"victory-score"}).textContent=`Final Score: ${e}`;const n=l.appendElement(i,"button",null,null,{id:"restart-button"});n.textContent="PLAY AGAIN",n.addEventListener("click",()=>{window.location.reload()})}}class ct{static show(){const e=l.appendElement(c,"div",null,null,{id:"start-overlay"}),t=l.appendElement(e,"div",null,null,{id:"start-container"});l.appendElement(t,"div",null,null,{id:"start-title"}).textContent="STAR WARS FIGHTER";const i=l.appendElement(t,"div",null,null,{id:"start-controls"});l.appendElement(i,"div",null,null,{id:"control-item"}).textContent="↑↓←→ - MOVE",l.appendElement(i,"div",null,null,{id:"control-item"}).textContent="S - SHOOT",l.appendElement(i,"div",null,null,{id:"control-item"}).textContent="R - RESTART",setTimeout(()=>{e.remove()},5e3)}}class pt{constructor(){o(this,"lastTime");o(this,"time");o(this,"ships");o(this,"xWing");o(this,"eventHandler");o(this,"playerShots");o(this,"enemyShots");o(this,"shipFactory");o(this,"hitDetector");o(this,"shipHandler");o(this,"shotHandler");o(this,"score");o(this,"sithFighterDefeated");o(this,"gameLoop",e=>{this.giveShipsManager(),this.countTime(e),this.checkVictory(),this.hitDetector.checkForHits(),this.shotHandler.moveShots(this.time),this.xWing.handleXWing(this.time),this.createShips(),requestAnimationFrame(this.gameLoop)});this.lastTime=0,this.time=0,this.ships=[],this.playerShots=[],this.enemyShots=[],this.score=0,this.sithFighterDefeated=!1,this.eventHandler=new j,this.xWing=new H(w.createXWingHtml(),10,this.eventHandler),this.shipFactory=new nt,this.hitDetector=new rt,this.shipHandler=new lt,this.shotHandler=new ht,this.registerPlayerShot=this.registerPlayerShot.bind(this),this.registerShot=this.registerShot.bind(this)}run(){this.xWing.setShotManager(this),this.xWing.setScoringManager(this),this.shipFactory.setShipManager(this),this.hitDetector.setUp(this,this,this),this.shipHandler.setShipManager(this),this.shotHandler.setUp(this,this),E.createInfoBar(this.xWing.hp),ct.show(),requestAnimationFrame(this.gameLoop)}createShips(){this.shipFactory.generateAsteroids(50,8,15,this.time),this.shipFactory.createTieSwarm(100,window.innerHeight/4,this.time,10,8),this.shipFactory.createTieSwarm(200,window.innerHeight*3/4,this.time,10,8),this.shipFactory.createShuttle(300,window.innerHeight/4,this.time,s.rng(.7,3)),this.shipFactory.createShuttle(301,window.innerHeight*3/4,this.time,s.rng(.7,3)),this.shipFactory.createShuttle(400,window.innerHeight/4,this.time,s.rng(.7,3)),this.shipFactory.createShuttle(401,window.innerHeight*3/4,this.time,s.rng(.7,3)),this.shipFactory.createShuttle(500,window.innerHeight/4,this.time,s.rng(.7,3)),this.shipFactory.createShuttle(501,window.innerHeight*3/4,this.time,s.rng(.7,3)),this.shipFactory.createStarDestroyer(700,window.innerHeight/2,this.time),this.shipFactory.createDeathStar(1e3,this.time),this.shipFactory.createTieSwarm(900,window.innerHeight/4,this.time,8,10),this.shipFactory.createTieSwarm(901,window.innerHeight*3/4,this.time,8,10),this.shipFactory.createShuttle(950,s.rng(window.innerHeight/8,window.innerHeight*7/8),this.time,s.rng(.7,3)),this.shipFactory.createShuttle(951,s.rng(window.innerHeight/8,window.innerHeight*7/8),this.time,s.rng(.7,3)),this.shipFactory.createSithFighter(1300,window.innerHeight/2,this.time),this.shipHandler.act(this.time)}giveShipsManager(){this.ships.forEach(e=>{e.setShipManager(this),e.setShotManager(this)})}countTime(e){this.lastTime||(this.lastTime=e),this.time=Math.round(e),this.lastTime=e}removeShip(e){this.ships=this.ships.filter(t=>e!==t)}addShip(e){this.ships.push(e)}getShips(){return this.ships}setShips(e){this.ships=e}getXWing(){return this.xWing}registerPlayerShot(e){this.playerShots.push(e)}getPlayerShots(){return this.playerShots}setPlayerShots(e){this.playerShots=e}getShots(){return this.enemyShots}registerShot(e){this.enemyShots.push(e)}setShots(e){this.enemyShots=e}removeShot(e){this.enemyShots=this.enemyShots.filter(t=>e!==t)}addScore(e){this.score+=e,E.updateScore(this.score)}getScore(){return this.score}checkVictory(){if(!this.sithFighterDefeated){const e=this.ships.some(i=>i instanceof M),t=this.ships.length>0&&this.ships.some(i=>i instanceof M);!e&&t&&(this.sithFighterDefeated=!0)}}triggerVictory(){this.sithFighterDefeated=!0,at.show(this.score)}}const mt=new pt;function dt(){mt.run()}dt();
